<div class="card">
  <h2>Unified Assets</h2>
  <p>
    This list is maintained by the JSON storage and rebuilt whenever mappings or sources change.
    Use the API endpoints under <code>/api/v1/assets</code> to automate rebuilds.
  </p>
  <button type="button" data-rebuild>Rebuild unified assets</button>
</div>

<div class="card">
  <h3>Schema</h3>
  {{#if schema.length}}
    <ul>
      {{#each schema}}
        <li>{{this}}</li>
      {{/each}}
    </ul>
  {{else}}
    <p>No schema columns defined yet.</p>
  {{/if}}
</div>

<div class="card">
  <h3>Sources</h3>
  {{#if sources.length}}
    <table class="table">
      <thead>
        <tr>
          <th>ID</th>
          <th>Name</th>
          <th>Filename</th>
          <th>Updated</th>
        </tr>
      </thead>
      <tbody>
        {{#each sources}}
          <tr>
            <td>{{id}}</td>
            <td><a href="/sources/{{id}}">{{name}}</a></td>
            <td>{{original_filename}}</td>
            <td>{{updated_at}}</td>
          </tr>
        {{/each}}
      </tbody>
    </table>
  {{else}}
    <p>No sources ingested yet.</p>
  {{/if}}
</div>

<div class="card">
  <h3>Unified asset rows</h3>
  {{#if assets.length}}
    <table class="table">
      <thead>
        <tr>
          <th>ID</th>
          <th>Canonical name</th>
          <th>Fields</th>
        </tr>
      </thead>
      <tbody>
        {{#each assets}}
          <tr>
            <td>{{id}}</td>
            <td>{{canonical_name}}</td>
            <td><pre>{{json fields}}</pre></td>
          </tr>
        {{/each}}
      </tbody>
    </table>
  {{else}}
    <p>The unified asset table is empty. Upload a source via the API to populate it.</p>
  {{/if}}
</div>
