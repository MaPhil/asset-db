<div
  class="asset-structure-app"
  data-app="asset-structure"
  data-topic-id="{{topic.id}}"
  data-sub-topic-id="{{subTopic.id}}"
  {{#if topic.measure.id}}data-measure-topic-id="{{topic.measure.id}}"{{/if}}
  {{#if subTopic.measure.id}}data-measure-sub-topic-id="{{subTopic.measure.id}}"{{/if}}
>
  <aside class="asset-structure-sidebar" aria-label="Asset-Struktur-Navigation">
    <div class="sidebar-section">
      <a href="/asset-structure" class="sidebar-link sidebar-link--active">Themengebiete</a>
      <a href="/asset-types" class="sidebar-link">Asset-Typen</a>
      <a href="/asset-categories" class="sidebar-link">Asset-Kategorien</a>
    </div>
  </aside>
  <section class="asset-structure-content">
    <header class="page-header">
      <div>
        <h1 class="page-title">{{#if subTopic.displayTitle}}{{subTopic.displayTitle}}{{else}}Unbenanntes Sub-Themengebiet{{/if}}</h1>
        <p class="page-subtitle">Überblick über die AssetUnterKategorien, die diesem Sub-Themengebiet zugeordnet sind.</p>
      </div>
      <div class="page-actions">
        {{#if subTopic.measuresUrl}}
          <a class="button button--ghost" href="{{subTopic.measuresUrl}}">Maßnahmen anzeigen</a>
        {{/if}}
        <a class="button button--ghost" href="/asset-structure/{{topic.id}}">Zum Themengebiet</a>
      </div>
    </header>

    <nav class="breadcrumb" aria-label="Breadcrumb">
      <a href="/asset-structure">Asset-Struktur</a>
      <span aria-hidden="true">›</span>
      <a href="/asset-structure/{{topic.id}}">{{topic.displayTitle}}</a>
      <span aria-hidden="true">›</span>
      <span aria-current="page">{{#if subTopic.displayTitle}}{{subTopic.displayTitle}}{{else}}Unbenanntes Sub-Themengebiet{{/if}}</span>
    </nav>

    <div class="structure-body">
      <section class="card structure-card" aria-labelledby="sub-topic-details-title">
        <div class="section-header">
          <h2 class="section-title" id="sub-topic-details-title">Sub-Themengebiet-Details</h2>
          <button class="button" type="button">Änderungen speichern</button>
        </div>
        <form class="form-grid">
          <div class="form-field">
            <label for="sub-topic-title">Titel</label>
            <input
              id="sub-topic-title"
              type="text"
              value="{{subTopic.displayTitle}}"
              disabled
              aria-disabled="true"
            />
          </div>
          <div class="form-field form-field--full">
            <label for="sub-topic-notes">Notizen</label>
            <textarea
              id="sub-topic-notes"
              name="notes"
              rows="4"
              placeholder="Relevante Informationen oder Aufgaben dokumentieren"
            >{{notes}}</textarea>
          </div>
        </form>
        <dl class="meta-grid">
          <div class="meta-item">
            <dt>Maßnahmen-Themengebiet</dt>
            <dd>{{#if topic.measure.title}}{{topic.measure.title}}{{else}}—{{/if}}</dd>
          </div>
          <div class="meta-item">
            <dt>Maßnahmen-Themengebiet ID</dt>
            <dd>{{#if topic.measure.id}}{{topic.measure.id}}{{else}}—{{/if}}</dd>
          </div>
          <div class="meta-item">
            <dt>Maßnahmen-Sub-Themengebiet</dt>
            <dd>{{#if subTopic.measure.title}}{{subTopic.measure.title}}{{else}}—{{/if}}</dd>
          </div>
          <div class="meta-item">
            <dt>Maßnahmen-Sub-Themengebiet ID</dt>
            <dd>{{#if subTopic.measure.id}}{{subTopic.measure.id}}{{else}}—{{/if}}</dd>
          </div>
        </dl>
      </section>

      <section class="structure-section" aria-labelledby="asset-sub-categories-title">
        <div class="section-header">
          <h2 class="section-title" id="asset-sub-categories-title">AssetUnterKategorien</h2>
        </div>
        <p class="helper-text">{{assetSubCategoryCount}} AssetUnterKategorien sind diesem Sub-Themengebiet zugeordnet.</p>
        <div class="card structure-card">
          {{#if assetSubCategories.length}}
            <div class="table-wrapper">
              <table class="table table--interactive" aria-describedby="asset-sub-categories-title">
                <thead>
                  <tr>
                    <th scope="col">AssetUnterKategorie</th>
                    <th scope="col">Gruppen</th>
                    <th scope="col">Verantwortlich</th>
                    <th scope="col">Integrität</th>
                    <th scope="col">Verfügbarkeit</th>
                    <th scope="col">Vertraulichkeit</th>
                    <th scope="col">Maßnahmen</th>
                  </tr>
                </thead>
                <tbody>
                  {{#*inline "assetSubCategoryCell"}}
                    <td>
                      {{#if isIgnored}}
                        <span class="table-link table-link--muted">{{value}}</span>
                      {{else}}
                        <a class="table-link" href="/asset-structure/{{../topic.id}}/{{../subTopic.id}}/{{id}}">{{value}}</a>
                      {{/if}}
                    </td>
                  {{/inline}}
                  {{#each assetSubCategories}}
                    <tr {{#if isIgnored}}data-asset-sub-category-ignored="true"{{/if}}>
                      {{> assetSubCategoryCell value=title}}
                      {{> assetSubCategoryCell value=groupCount}}
                      {{> assetSubCategoryCell value=owner}}
                      {{> assetSubCategoryCell value=integrity}}
                      {{> assetSubCategoryCell value=availability}}
                      {{> assetSubCategoryCell value=confidentiality}}
                      <td>
                        {{#if measuresUrl}}
                          {{#if isIgnored}}
                            <span class="table-link table-link--muted">In Maßnahmen öffnen</span>
                          {{else}}
                            <a class="table-link table-link--muted" href="{{measuresUrl}}">In Maßnahmen öffnen</a>
                          {{/if}}
                        {{else}}
                          —
                        {{/if}}
                      </td>
                    </tr>
                  {{/each}}
                </tbody>
              </table>
            </div>
          {{else}}
            <p class="empty-state">Diesem Sub-Themengebiet sind noch keine AssetUnterKategorien zugeordnet.</p>
          {{/if}}
        </div>
      </section>
    </div>
  </section>
</div>
